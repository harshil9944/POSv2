Vue.component("vue-modal",window.bootstrapVue.default);function _s(key,namespace){if(typeof namespace=="undefined"){namespace="erpData"}return window[namespace][key]}function loadDataTable(){var table=$("#data-list-table");if(table.length){$(table).DataTable({responsive:true,pageLength:8,autoWidth:!1,searching:!1,oLanguage:{sLengthMenu:""},columnDefs:[{targets:"no-sort",orderable:false}],dom:"<'row'<'col-sm-12'tr>><'row'<'col-sm-6'i><'col-sm-6'p>>"})}}function submitRequest(data,method){return Promise.resolve($.ajax({url:_s("action"),type:method.toUpperCase(),crossDomain:true,dataType:"json",data:data,beforeSend:function(xhr){xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");xhr.setRequestHeader("key",_s("key"));xhr.setRequestHeader("id",_s("user_id"))}}))}function uploadRequest(formData){return Promise.resolve($.ajax({url:_s("action"),type:"POST",dataType:"json",data:formData,contentType:false,cache:false,processData:false,beforeSend:function(xhr){xhr.setRequestHeader("X-Requested-With","XMLHttpRequest")}}))}function ds_alert(message){Codebase.helpers("notify",{align:"right",from:"top",type:"info",icon:"fa fa-info mr-5",message:message})}function ds_confirm(message){return confirm(message)}function sortByKey(array,key){return array.sort(function(a,b){var x=a[key];var y=b[key];if(typeof x=="string"){x=(""+x).toLowerCase()}if(typeof y=="string"){y=(""+y).toLowerCase()}return x<y?-1:x>y?1:0})}Vue.filter("toTwoDecimal",function(d){if(typeof d!="undefined"){return Number(d).toFixed(2)}});Vue.filter("toNoDecimal",function(d){if(typeof d!="undefined"){return Number(d).toFixed(0)}});Vue.filter("beautifyCurrency",function(value){value=Number(value);return _s("currencySign")+value.toLocaleString("hi-IN")});Vue.filter("beautifyDate",function(date){if(date!=null){var format=_s("mDateFormat");return moment(date).format(format)}else{return""}});var bus=new Vue({data:{isLoading:false,category:""},methods:{showLoader:function(){this.isLoading=true},hideLoader:function(){this.isLoading=false}}});if(typeof obj!="undefined"){Vue.component("gen-form",{template:"#general-form-template",data:function(){return{defaultObj:JSON.parse(JSON.stringify(obj)),obj:obj,module:_s("currentModule"),active:false,mode:"",updateBtnText:""}},methods:{handleChange:function(event_name,value){bus.$emit(event_name,value)},handleAdd:function(){this.mode="add";this.updateBtnText="Add";this.active=true},handleEdit:function(id){var self=this;this.mode="edit";this.updateBtnText="Save Changes";this.active=true;var data={id:id,module:this.module.path};var request=submitRequest(data,"get");request.then(function(response){if(response.status=="ok"){self.obj=response.obj}})},handleRemove:function(id){if(ds_confirm("Are you sure to delete this item?")){return;var data={module:this.module.path,id:id};var request=submitRequest(data,"delete");request.then(function(response){if(response.status=="ok"){window.location=response.redirect}else{var message="";if(typeof response.message!="undefined"){message=response.message}ds_alert(message)}})}},handleSubmit:function(){if($("#frm-general-edit").parsley().validate()){var data={module:this.module.path,obj:this.obj};var method="";if(this.mode=="add"){method="put"}if(this.mode=="edit"){method="post"}if(method!=""){var request=submitRequest(data,method);request.then(function(response){if(response.status=="ok"){window.location=response.redirect}else{var message="";if(typeof response.message!="undefined"){message=response.message}ds_alert(message)}})}}},handleCancel:function(){this.resetForm()},resetForm:function(){this.obj=JSON.parse(JSON.stringify(this.defaultObj));this.mode="";this.updateBtnText="";this.active=false}},created:function(){var self=this;bus.$on("addItem",function(){self.handleAdd()});bus.$on("editItem",function(value){self.handleEdit(value)});bus.$on("removeItem",function(value){self.handleRemove(value)})}})}