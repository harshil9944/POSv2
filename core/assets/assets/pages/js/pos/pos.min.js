Vue.filter("imagePath",function(src){if(src!=""&&src!=null){return _s("imgCacheUrl")+src}else{return _s("noImgUrl")}});new Vue({el:"#brahma-pos",data:function(){return{module:"pos",masters:{taxRate:5,categories:[],items:[],units:[]},modal:{item:{image:"tile.png",title:"Happy Balanco",features:[{key:"Product",value:"Happy Balanco"},{key:"Material",value:"Ceramic"},{key:"Finish",value:"Gloss"},{key:"Usage",value:"Wall"},{key:"Size",value:"20 x 50"},{key:"Tiles per M2",value:"10"},{key:"M2 per Box",value:"1.2"},{key:"Pieces per Box",value:"12"},{key:"Piece Weight",value:"1.48"},{key:"Box Weight",value:"17.80"}]}},cart:{items:[],subTotal:0,taxTotal:0,grandTotal:0},category_id:""}},watch:{"cart.items":{handler:function(values,oldValues){var self=this;var subTotal=0;self.cart.items.forEach(function(item,index){self.cart.items[index].quantity=Math.ceil(Number(self.cart.items[index].quantity));subTotal=Number(subTotal)+Number(item.quantity)*Number(item.rate)});var taxTotal=Number(subTotal)*Number(self.masters.taxRate)/Number(100);self.cart.subTotal=subTotal;self.cart.taxTotal=taxTotal;self.cart.grandTotal=Number(subTotal)+Number(taxTotal)},deep:true}},methods:{calculateUnitPrice:function(symbol,a,b){switch(symbol){case"+":return Number(a)+Number(b);case"-":return Number(a)-Number(b);case"*":return Number(a)*Number(b);case"/":return Number(a)/Number(b)}},reverseCalculateUnitPrice:function(symbol,a,b){switch(symbol){case"+":return Number(a)-Number(b);case"-":return Number(a)+Number(b);case"*":return Number(a)/Number(b);case"/":return Number(a)*Number(b)}},populateMeta:function(){var self=this;var data={module:self.module,method:"populate",category:""};var request=submitRequest(data,"get");request.then(function(response){if(response.status=="ok"){self.masters.categories=response.categories;self.masters.items=response.items;self.masters.units=response.units}})},filterCategoryItems:function(){Codebase.blocks("#product-container","state_loading");var self=this;var data={module:self.module,method:"category_items",category:this.category_id};var request=submitRequest(data,"get");request.then(function(response){if(response.status=="ok"){self.masters.items=response.items;Codebase.blocks("#product-container","state_normal")}})},handleItemClick:function(index){var id=this.masters.items[index].id;var self=this;Codebase.blocks("#item-detail-block","state_loading");self.$bvModal.show("item-detail-modal");var self=this;var data={module:this.module,method:"single_item",id:id};var request=submitRequest(data,"get");request.then(function(response){if(response.status=="ok"){self.modal.item=response.obj;self.modal.item.quantity=1;self.modal.item.units=[];var units=self.masters.units.filter(function(unit){return unit.id===self.modal.item.unit||unit.baseUnit===self.modal.item.unit});units.forEach(function(unit){unit.quantity=1;self.modal.item.units.push(unit)});Codebase.blocks("#item-detail-block","state_normal")}})},loadSampleDate:function(){this.cart.items=[{id:1,title:"Happy Balanco",quantity:1,rate:11.99,discount:0,note:""},{id:2,title:"Happy Negro",quantity:1,rate:11.99,discount:0,note:""},{id:3,title:"Altai Natural Black",quantity:1,rate:36.99,discount:0,note:""},{id:4,title:"Altai Natural White",quantity:1,rate:36.99,discount:0,note:""},{id:5,title:"Basis Light Grey",quantity:1,rate:31,discount:0,note:""}]},handleChangeCategory:function(id){this.category_id=id;this.filterCategoryItems()}},created:function(){this.loadSampleDate();this.populateMeta()}});